namespace SpriteKind {
    export const Virtical = SpriteKind.create()
    export const Horizontal = SpriteKind.create()
}
controller.up.onEvent(ControllerButtonEvent.Pressed, function () {
    moveV(-16)
})
controller.down.onEvent(ControllerButtonEvent.Released, function () {
    moveV(16)
})
function MoveH (direction: number) {
    for (let H_sprite of H_list) {
        overlap = false
        for (let V_sprite of V_list) {
            if (H_sprite.overlapsWith(V_sprite)) {
                overlap = true
            }
        }
        if (!(overlap)) {
            H_sprite.x += direction
            if (16 == H_sprite.left) {
                H_sprite.x += 0 - direction
            }
            if (144 == H_sprite.right) {
                H_sprite.x += 0 - direction
            }
        }
        for (let V_sprite of V_list) {
            if (H_sprite.overlapsWith(V_sprite)) {
                overlap = true
            }
        }
        if (overlap) {
            H_sprite.x += 0 - direction
        }
    }
}
controller.left.onEvent(ControllerButtonEvent.Released, function () {
    MoveH(-16)
})
function moveV (direction: number) {
    for (let V_sprite of V_list) {
        overlap = false
        for (let H_sprite of H_list) {
            if (V_sprite.overlapsWith(H_sprite)) {
                overlap = true
            }
        }
        if (!(overlap)) {
            V_sprite.y += direction
            if (0 == V_sprite.top) {
                if (V_sprite.x != 72) {
                    V_sprite.y += 0 - direction
                }
            }
            if (128 == V_sprite.bottom) {
                V_sprite.y += 0 - direction
            }
        }
        for (let H_sprite of H_list) {
            if (V_sprite.overlapsWith(H_sprite)) {
                overlap = true
            }
        }
        if (overlap) {
            V_sprite.y += 0 - direction
        }
    }
}
controller.right.onEvent(ControllerButtonEvent.Pressed, function () {
    MoveH(16)
})
let overlap = false
let H_list: Sprite[] = []
let V_list: Sprite[] = []
scene.setBackgroundColor(11)
tiles.setTilemap(tiles.createTilemap(hex`0a0008000202020201020202020202020101010101010202020201010101010102020202010101010101020202020101010101010202020201010101010102020202010101010101020202020202020202020202`, img`
    2 2 2 2 . 2 2 2 2 2 
    2 2 . . . . . . 2 2 
    2 2 . . . . . . 2 2 
    2 2 . . . . . . 2 2 
    2 2 . . . . . . 2 2 
    2 2 . . . . . . 2 2 
    2 2 . . . . . . 2 2 
    2 2 2 2 2 2 2 2 2 2 
    `, [myTiles.transparency16,myTiles.tile1,myTiles.tile2], TileScale.Sixteen))
let Driver = sprites.create(img`
    ...2552222552...
    ..222222222222..
    ff222222222222ff
    ff222222222222ff
    ff222222222222ff
    ff222222222222ff
    ff222222222222ff
    ..222244442222..
    ..222444444222..
    ..224444444422..
    ..224444444422..
    ..224444444422..
    ..224444444422..
    ..224444444422..
    ..224444444422..
    ..224444444422..
    ..224444444422..
    ..224444444422..
    ..224444444422..
    ..224444444422..
    ..224444444422..
    ..224444444422..
    ..224444444422..
    ff224444444422ff
    ff224444444422ff
    ff224444444422ff
    ff224444444422ff
    ff224444444422ff
    ff224444444422ff
    ..222444444222..
    ...2222222222...
    ..........dd....
    `, SpriteKind.Virtical)
Driver.setPosition(72, 64)
let Limo_V3 = sprites.create(img`
    1114541111454111
    .11454111145411.
    ..114111111411..
    ff111111111111ff
    ff111111111111ff
    ff111ffffff111ff
    ff11ffffffff11ff
    ff11ffffffff11ff
    ff11ffffffff11ff
    ..11ffffffff11..
    .111ffffffff111.
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    1111ffffffff1111
    .111ffffffff111.
    ..11ffffffff11..
    ff11ffffffff11ff
    ff11ffffffff11ff
    ff11ffffffff11ff
    ff11ffffffff11ff
    ff11ffffffff11ff
    ff11ffffffff11ff
    ..111ffffff111..
    .11111111111111.
    1111111111111111
    `, SpriteKind.Virtical)
Limo_V3.setPosition(88, 40)
let Limo_H3 = sprites.create(img`
    1..ffffff..11111111111111111111111111..ffffff..1
    11.ffffff.1111111111111111111111111111.ffffff.11
    111111111111111111111111111111111111111111111111
    111111111111111111111111111111111111111111111144
    111fffffffffffffffffffffffffffffffffffffff111455
    11fffffffffffffffffffffffffffffffffffffffff11144
    11fffffffffffffffffffffffffffffffffffffffff11111
    11fffffffffffffffffffffffffffffffffffffffff11111
    11fffffffffffffffffffffffffffffffffffffffff11111
    11fffffffffffffffffffffffffffffffffffffffff11111
    11fffffffffffffffffffffffffffffffffffffffff11144
    111fffffffffffffffffffffffffffffffffffffff111455
    111111111111111111111111111111111111111111111144
    111111111111111111111111111111111111111111111111
    11.ffffff.1111111111111111111111111111.ffffff.11
    1..ffffff..11111111111111111111111111..ffffff..1
    `, SpriteKind.Horizontal)
Limo_H3.setPosition(56, 40)
V_list = sprites.allOfKind(SpriteKind.Virtical)
H_list = sprites.allOfKind(SpriteKind.Horizontal)
for (let V_sprite of V_list) {
    V_sprite.setFlag(SpriteFlag.StayInScreen, true)
}
for (let H_sprite of H_list) {
    H_sprite.setFlag(SpriteFlag.StayInScreen, true)
}
game.onUpdate(function () {
    if (Driver.y == 0) {
        animation.runImageAnimation(
        Driver,
        [img`
            ...2552222552...
            ..222222222222..
            ff222222222222ff
            ff222222222222ff
            ff222222222222ff
            ff222222222222ff
            ff222222222222ff
            ..222244442222..
            ..222444444222..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ..222444444222..
            ...2222222222...
            ..........dd....
            `,img`
            ff222222222222ff
            ff222222222222ff
            ff222222222222ff
            ff222222222222ff
            ff222222222222ff
            ..222244442222..
            ..222444444222..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ..222444444222..
            ...2222222222...
            ..........dd....
            ................
            ................
            `,img`
            ff222222222222ff
            ff222222222222ff
            ff222222222222ff
            ..222244442222..
            ..222444444222..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ..222444444222..
            ...2222222222...
            ..........dd....
            ................
            ................
            ................
            ................
            `,img`
            ff222222222222ff
            ..222244442222..
            ..222444444222..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ..222444444222..
            ...2222222222...
            ..........dd....
            ................
            ................
            ................
            ................
            ................
            ................
            `,img`
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ..222444444222..
            ...2222222222...
            ..........dd....
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            `,img`
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ..224444444422..
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ..222444444222..
            ...2222222222...
            ..........dd....
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            `,img`
            ..224444444422..
            ..224444444422..
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ff224444444422ff
            ..222444444222..
            ...2222222222...
            ..........dd....
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            `,img`
            ..222444444222..
            ...2222222222...
            ..........dd....
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            `,img`
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            `],
        100,
        false
        )
        timer.after(1000, function () {
            game.over(true)
        })
    }
})
